<?xml version="1.0" ?>
<node name="/Connection_Interface_Contact_Attributes" xmlns:tp="http://telepathy.freedesktop.org/wiki/DbusSpec#extensions-v0">
  <tp:copyright> Copyright (C) 2005-2008 Collabora Limited </tp:copyright>
  <tp:copyright> Copyright (C) 2005, 2006 Nokia Corporation </tp:copyright>
  <tp:copyright> Copyright (C) 2006 INdT </tp:copyright>
  <tp:license xmlns="http://www.w3.org/1999/xhtml">
    <p>This library is free software; you can redistribute it and/or modify it
      under the terms of the GNU Lesser General Public License as published by
      the Free Software Foundation; either version 2.1 of the License, or (at
      your option) any later version.</p>

    <p>This library is distributed in the hope that it will be useful, but
      WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
      General Public License for more details.</p>

    <p>You should have received a copy of the GNU Lesser General Public License
      along with this library; if not, write to the Free Software Foundation,
      Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</p>
  </tp:license>
  <interface name="org.freedesktop.Telepathy.Connection.Interface.Contacts.DRAFT"
    tp:causes-havoc="experimental">
    <tp:requires interface="org.freedesktop.Telepathy.Connection"/>

    <tp:docstring xmlns="http://www.w3.org/1999/xhtml">
      <p>This interface allows many attributes of many contacts to be
        obtained in a single D-Bus round trip.</p>

      <p>Each contact attribute has an string identifier
        (<tp:type>Contact_Attribute</tp:type>), which is namespaced
        by the D-Bus interface which defines it.</p>

      <p>While this interface is a draft, an initial set of contact
        attributes is defined here. The definitions of these attributes
        will be moved to the spec for individual interfaces when this interface
        is finalized.</p>

      <dl>
        <dt>org.freedesktop.Telepathy.Connection/contact-id
          (type s)</dt>
        <dd>The same string that would be returned by <tp:dbus-ref
            namespace="org.freedesktop.Telepathy.Connection">InspectHandles</tp:dbus-ref>
          (always present in the result)
        </dd>
        <dt>org.freedesktop.Telepathy.Connection.Interface.Aliasing/alias
          (type s)</dt>
        <dd>The contact's alias as defined by the <tp:dbus-ref
            namespace="org.freedesktop.Telepathy.Connection.Interface">Aliasing</tp:dbus-ref>
          interface (omitted from the result if the contact has no alias,
          their alias is not immediately known, or information from the
          Aliasing interface was not requested)
        </dd>
        <dt>org.freedesktop.Telepathy.Connection.Interface.Avatars/token
          (type s</dt>
        <dd>The same string that would be returned by <tp:dbus-ref
            namespace="org.freedesktop.Telepathy.Connection.Interface.Avatars">GetAvatarTokens</tp:dbus-ref>
          (omitted from the result if the contact has no avatar, their
          avatar-token is not known, or information from the Avatars interface
          was not requested)
        </dd>
        <dt>org.freedesktop.Telepathy.Connection.Interface.SimplePresence/presence
          (type (uss), <tp:type>Simple_Presence</tp:type>)</dt>
        <dd> The same struct that would be returned by
            <tp:dbus-ref
              namespace="org.freedesktop.Telepathy.Connection.Interface.SimplePresence">GetPresences</tp:dbus-ref>
          (omitted from the result if the contact's presence is not known,
          or information from the SimplePresence interface was not requested)
          </dd>
        <dt>org.freedesktop.Telepathy.Connection.Interface.Capabilities/caps
          (type a(usuu), <tp:type>Contact_Capability</tp:type>)</dt>
        <dd>The same structs that would be returned by
          <tp:dbus-ref namespace="org.freedesktop.Telepathy.Connection.Interface.Capabilities">GetCapabilities</tp:dbus-ref>
          (all of them will redundantly have the contact's handle as the
          first member). Omitted from the result if the contact's capabilities
          are not known, or information from the Capabilities interface was
          not requested; present in the result as an empty array if the
          contact is known to have no capabilities at all.</dd>
      </dl>
    </tp:docstring>

    <tp:simple-type name="Contact_Attribute" type="s">
      <tp:docstring>
        A <tp:type>DBus_Interface</tp:type>, followed by a slash '/' character
        and an identifier for an attribute defined by that interface. The
        attribute identifier SHOULD be in lower case.

        <tp:rationale>
          These aren't D-Bus core Properties, and we want them to look visibly
          different.
        </tp:rationale>
      </tp:docstring>
    </tp:simple-type>

    <method name="InspectContacts">
      <arg direction="in" name="handles" type="au" tp:type="Contact_Handle[]">
        <tp:docstring>
          An array of Handle_Type_Contact integer handles
        </tp:docstring>
      </arg>

      <arg direction="in" name="commands" type="as"
        tp:type="Contact_Inspection_Command[]">
        <tp:docstring>
          A list of strings indicating which commands to perform on each
          contact. See <tp:type>Contact_Inspection_Command</tp:type> for more
          details.
        </tp:docstring>
      </arg>

      <arg direction="out" type="a{ua{sv}}"
        tp:type="Contact_Attributes_Map">
        <tp:docstring>
          A dictionary mapping the contact handles to contact attributes.
        </tp:docstring>
      </arg>

      <tp:docstring>
        Return any number of basic contact attributes for the given handles.

        If a handle is invalid for any reason, an
        org.freedesktop.Telepathy.Error.InvalidHandle error will be raised, and
        that handle will be excluded from the results. In this case,
        InspectContacts will still return values for all the valid handles.
      </tp:docstring>

      <tp:possible-errors>
        <tp:error name="org.freedesktop.Telepathy.Error.Disconnected"/>
        <tp:error name="org.freedesktop.Telepathy.Error.InvalidArgument">
          The flags are invalid
        </tp:error>
        <tp:error name="org.freedesktop.Telepathy.Error.InvalidHandle">
          One of the given handles is inactive and/or not Handle_Type_Contact
        </tp:error>
      </tp:possible-errors>
    </method>
  </interface>
</node>
<!-- vim:set sw=2 sts=2 et ft=xml: -->
